(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{357:function(t,s,a){"use strict";a.r(s);var e=a(10),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"reactæ ¸å¿ƒæ¶æ„fiberè§£æ-å…¥é—¨ç¯‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reactæ ¸å¿ƒæ¶æ„fiberè§£æ-å…¥é—¨ç¯‡"}},[t._v("#")]),t._v(" Reactæ ¸å¿ƒæ¶æ„Fiberè§£æâ€”â€”å…¥é—¨ç¯‡")]),t._v(" "),s("blockquote",[s("p",[t._v("é¦–å…ˆï¼Œå†™è¿™ç¯‡æ–‡ç« çš„ä¸»è¦ç›®çš„æ˜¯æƒ³è®©å¤§å®¶èƒ½å¤ŸçŸ¥é“ä¸ºä»€ä¹ˆFiberæ¶æ„èƒ½å¤Ÿæé«˜æ€§èƒ½ï¼Œè®©é¡µé¢æ¸²æŸ“æ›´åŠ æµç•…ï¼Œä»è€Œæé«˜ç”¨æˆ·ä½“éªŒã€‚è¿™é‡Œï¼Œæˆ‘ä»¥ä¸€ä¸ªåˆå­¦è€…çš„è§’åº¦å»å†™äº†è¿™ç¯‡æ–‡ç« ï¼Œè¿™ç¯‡æ–‡ç« ä¸­ä¹Ÿå›ç­”äº†æˆ‘åˆå­¦Fiberè¿‡ç¨‹ä¸­çš„ç§ç§ç–‘é—®ï¼Œç®—æ˜¯ä¸€ç¯‡å…¥é—¨çš„æ–‡ç« ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°å¤§å®¶ã€‚")])]),t._v(" "),s("h2",{attrs:{id:"å‰ç½®å­¦ä¹ "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‰ç½®å­¦ä¹ "}},[t._v("#")]),t._v(" å‰ç½®å­¦ä¹ ")]),t._v(" "),s("h4",{attrs:{id:"å¸§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å¸§"}},[t._v("#")]),t._v(" å¸§")]),t._v(" "),s("p",[t._v("ç›®å‰å¤§å¤šæ•°è®¾å¤‡çš„å±å¹•åˆ·æ–°ç‡ä¸º60æ¬¡/ç§’")]),t._v(" "),s("p",[t._v("å½“æ¯ç§’ç»˜åˆ¶çš„å¸§æ•°ï¼ˆFPSï¼‰è¾¾åˆ°60æ—¶ï¼Œé¡µé¢æ—¶æµç•…çš„ï¼Œå°äºè¿™ä¸ªå€¼æ—¶ï¼Œç”¨æˆ·ä¼šæ„Ÿè§‰åˆ°å¡é¡¿ï¼Œå› æ­¤ä¸ºäº†é˜²æ­¢ç•Œé¢å¡é¡¿ï¼Œæ¯ä¸ªå¸§çš„é¢„ç®—æ—¶é—´æ—¶16.66æ¯«ç§’ï¼ˆ1ç§’/60ï¼‰")]),t._v(" "),s("p",[t._v("æ¯ä¸ªå¸§çš„å¼€å¤´åŒ…æ‹¬æ ·å¼è®¡ç®—ã€å¸ƒå±€å’Œç»˜åˆ¶")]),t._v(" "),s("p",[t._v("JavaScriptæ‰§è¡Œçš„JavaScriptå¼•æ“çº¿ç¨‹å’ŒGUIæ¸²æŸ“çº¿ç¨‹æ˜¯äº’æ–¥çš„")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302175718.png",alt:"image-20201118101416004"}})]),t._v(" "),s("p",[t._v("å¦‚æœæŸä¸ªJavaScriptæŸä¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œä¼šé˜»å¡GUIæ¸²æŸ“é¡µé¢")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302175739.png",alt:"image-20201121205334272"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302175806.png",alt:"image-20201118093003534"}})]),t._v(" "),s("h4",{attrs:{id:"ä¸¢å¸§"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸¢å¸§"}},[t._v("#")]),t._v(" ä¸¢å¸§")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302175851.png",alt:"image-20201122163103566"}})]),t._v(" "),s("p",[t._v("åœ¨ä¸€ä¸ªæ ‡å‡†å¸§æ¸²æŸ“æ—¶é—´16.7msä¹‹å†…ï¼Œæµè§ˆå™¨éœ€è¦å®ŒæˆMainçº¿ç¨‹çš„æ“ä½œï¼Œå¹¶commitç»™Compositorè¿›ç¨‹")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302175904.png",alt:"image-20201121204312674"}})]),t._v(" "),s("p",[t._v("ä¸»çº¿ç¨‹é‡Œæ“ä½œå¤ªå¤šï¼Œè€—æ—¶é•¿ï¼Œcommitçš„æ—¶é—´è¢«æ¨è¿Ÿï¼Œæµè§ˆå™¨æ¥ä¸åŠå°†é¡µé¢drawåˆ°å±å¹•ï¼Œè¿™å°±ä¸¢å¤±äº†ä¸€å¸§ã€‚")]),t._v(" "),s("blockquote",[s("p",[t._v("æ›´å¤šå†…å®¹å¯å‚è€ƒâ€”â€”"),s("a",{attrs:{href:"https://developers.google.com/web/fundamentals/performance/rendering/?hl=zh-cn",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google Developers"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("ä¸¾ä¸ªæ —å­ğŸŒ°")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302175913.png",alt:"image-20201121210052334"}})]),t._v(" "),s("center",[s("a",{attrs:{href:"https://claudiopro.github.io/react-fiber-vs-stack-demo/"}},[t._v("Reactâ€”â€”StackVsFiber")])]),t._v(" "),s("h4",{attrs:{id:"react-15"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react-15"}},[t._v("#")]),t._v(" React 15")]),t._v(" "),s("p",[t._v("vDom Treeâ€”â€”ç›¸å¯¹ç®€å•çš„æ ‘çŠ¶ç»“æ„")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302175947.png",alt:"image-20201123103937085"}})]),t._v(" "),s("p",[t._v("æ•°æ®ç»“æ„è¡¨ç¤ºï¼š")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" el "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"props"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"children"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"props"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"b1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"children"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"props"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c1"')]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"div"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"props"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"c2"')]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br")])]),s("p",[t._v("è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœèŠ‚ç‚¹çš„å±‚çº§è¿‡äºæ·±ï¼Œä¼šå¯¼è‡´é€’å½’æ ˆè¿‡æ·±ã€‚æˆ‘ä»¬çŸ¥é“æ ˆæ˜¯æ— æ³•ä¸­æ–­çš„ï¼Œæ‰€ä»¥åœ¨Diffçš„è¿‡ç¨‹ä¸­ä¼šå‡ºç°æ€§èƒ½é—®é¢˜ã€‚")]),t._v(" "),s("h4",{attrs:{id:"react16"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#react16"}},[t._v("#")]),t._v(" React16")]),t._v(" "),s("p",[t._v("è¿™é‡Œå†æ¬¡æ”¾å‡ºæµè§ˆå™¨çš„ä¸€å¸§")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302180008.png",alt:"image-20201121213340556"}})]),t._v(" "),s("blockquote",[s("p",[t._v("å›¾ä¸­çš„Idle periodå¯¹åº”Chromeä¸­æä¾›çš„APIâ€”â€”"),s("a",{attrs:{href:"https://developers.google.com/web/updates/2015/08/using-requestidlecallback?hl=en",target:"_blank",rel:"noopener noreferrer"}},[t._v("requestIdleCallback"),s("OutboundLink")],1)])]),t._v(" "),s("h5",{attrs:{id:"requestidlecallback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#requestidlecallback"}},[t._v("#")]),t._v(" requestIdleCallback")]),t._v(" "),s("ul",[s("li",[t._v("æˆ‘ä»¬å¸Œæœ›å¿«é€Ÿå“åº”ç”¨æˆ·ï¼Œè®©ç”¨æˆ·ç›´è§‚ä¸Šè§‰å¾—æµç•…ï¼Œå› æ­¤ä¸èƒ½é˜»å¡ç”¨æˆ·çš„äº¤äº’")]),t._v(" "),s("li",[t._v("requestIdleCallbackä½¿å¼€å‘è€…èƒ½å¤Ÿåœ¨ä¸»äº‹ä»¶å¾ªç¯ä¸Šæ‰§è¡Œåå°å’Œä½ä¼˜å…ˆçº§å·¥ä½œï¼Œè€Œä¸ä¼šå½±å“å»¶è¿Ÿå…³é”®äº‹ä»¶ï¼Œå¦‚åŠ¨ç”»å’Œè¾“å…¥å“åº”")]),t._v(" "),s("li",[t._v("æ­£å¸¸å¸§ä»»åŠ¡å®Œæˆåæ²¡è¶…è¿‡16msï¼Œè¯´æ˜æ—¶é—´æœ‰å¯Œä½™ï¼Œæ­¤æ—¶å°±ä¼šæ‰§è¡ŒrequestIdleCallbacké‡Œæ³¨å†Œçš„ä»»åŠ¡")]),t._v(" "),s("li",[t._v("requestAnimationFrameçš„å›è°ƒä¼šåœ¨æ¯ä¸€å¸§ç¡®å®šæ‰§è¡Œï¼Œå±äºé«˜ä¼˜å…ˆçº§ä»»åŠ¡ï¼Œè€ŒrequestIdleCallbackçš„å›è°ƒåˆ™ä¸ä¸€å®šï¼Œå±äºä½ä¼˜å…ˆçº§ä»»åŠ¡")]),t._v(" "),s("li",[t._v("requestIdleCallbackæ‰§è¡Œæœ‰ä¸¤ç§å¯èƒ½æ€§ï¼š\n"),s("ol",[s("li",[t._v("ä¸€ç§æ˜¯æ­£å¸¸çš„ç©ºé—²æ—¶é—´")]),t._v(" "),s("li",[t._v("å¦å¤–ä¸€ç§æƒ…å†µæ˜¯ï¼Œå¦‚æœæµè§ˆå™¨é•¿æœŸæ²¡æœ‰ä»»åŠ¡å¯åšï¼Œé‚£ä¹ˆæ­¤æ—¶å®ƒä¼šåˆ†é…ç»™ä½ æ›´å¤šçš„æ—¶é—´â€”â€”ä¸€èˆ¬ä¸º50ms")])])])]),t._v(" "),s("p",[t._v("ä»¥ä¸‹æ˜¯React16 Diffçš„è¿‡ç¨‹ä¸­è°ƒåº¦çš„è¿‡ç¨‹ä»¥åŠç­–ç•¥ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302180026.png",alt:"image-20201122161247158"}})]),t._v(" "),s("p",[t._v("å¯¹æµç¨‹1ã€2ã€3è¿›è¡Œæ”¾å¤§")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302180047.png",alt:"image-20201123103830513"}})]),t._v(" "),s("h2",{attrs:{id:"ä»€ä¹ˆæ˜¯fiber"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯fiber"}},[t._v("#")]),t._v(" ä»€ä¹ˆæ˜¯Fiber")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬å¯ä»¥é€šè¿‡æŸç§è°ƒåº¦ç­–ç•¥æ¥åˆç†åˆ†é…CPUèµ„æºï¼Œä»è€Œæé«˜ç”¨æˆ·çš„å“åº”é€Ÿåº¦â€”â€”é€šè¿‡Fiberæ¶æ„ï¼Œè®©è‡ªå·±çš„åè°ƒè¿‡ç¨‹å˜æˆå¯è¢«ä¸­æ–­ã€‚é€‚æ—¶åœ°è®©å‡ºCPUæ‰§è¡Œæƒï¼Œè¿™æ ·å¯ä»¥è®©æµè§ˆå™¨åŠæ—¶åœ°å“åº”ä¼˜å…ˆçº§æ›´é«˜çš„ç”¨æˆ·äº¤äº’æ—¶é—´ï¼Œç”¨æˆ·èƒ½å¤Ÿç›´è§‚åœ°æ„Ÿå—åˆ°ç«‹åˆ»è¢«å“åº”äº†ï¼Œå› æ­¤ç”¨æˆ·ä½“éªŒä¹Ÿå¤§å¤§åœ°æé«˜äº†")]),t._v(" "),s("h4",{attrs:{id:"fiberæ˜¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fiberæ˜¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒ"}},[t._v("#")]),t._v(" Fiberæ˜¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒ")]),t._v(" "),s("p",[t._v("â€‹\tFiberæ˜¯ä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼Œæ¯æ¬¡æ‰§è¡Œå®Œä¸€ä¸ªæ‰§è¡Œå•å…ƒï¼ŒReactå°±ä¼šæ£€æŸ¥ç°åœ¨è¿˜å‰©å¤šå°‘æ—¶é—´ï¼Œå¦‚æœæ²¡æœ‰æ—¶é—´å°±å°†æ§åˆ¶æƒè®©å‡ºå»")]),t._v(" "),s("h4",{attrs:{id:"fiberæ˜¯ä¸€ç§æ•°æ®ç»“æ„"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fiberæ˜¯ä¸€ç§æ•°æ®ç»“æ„"}},[t._v("#")]),t._v(" Fiberæ˜¯ä¸€ç§æ•°æ®ç»“æ„")]),t._v(" "),s("ul",[s("li",[t._v("Reactçš„åšæ³•æ˜¯ä½¿ç”¨é“¾è¡¨ï¼Œæ¯ä¸ªè™šæ‹ŸèŠ‚ç‚¹å†…éƒ¨è¡¨ç¤ºä¸ºFiber")])]),t._v(" "),s("blockquote",[s("p",[t._v("ä½¿ç”¨é“¾è¡¨çš„å¥½å¤„â€”â€”æš‚åœéå†")]),t._v(" "),s("ul",[s("li",[t._v("åœ¨React Diffçš„è¿‡ç¨‹ä¸­å‡ºç°äº†ä¸­æ–­è®©æƒç­‰å¾…çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥éå¸¸æ–¹ä¾¿çš„ä¿å­˜çŠ¶æ€ï¼Œæˆ‘ä»¬åªéœ€ä¿å­˜ä¸­æ–­çš„é“¾è¡¨å¤´å°±è¡Œäº†ï¼Œä¸‹æ¬¡æ¢å¤çŠ¶æ€çš„æ—¶å€™åªéœ€è¦æ ¹æ®é“¾è¡¨å¤´å³å¯è·å–ä¹‹å‰å·²ç»å¤„ç†è¿‡çš„èŠ‚ç‚¹äº†")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302180120.png",alt:"image-20201118101922878"}})]),t._v(" "),s("p",[t._v("Fiber Treeçš„æ•°æ®ç»“æ„ç®€å•è¡¨ç¤ºï¼š")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("Fiber"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  child"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æŒ‡å‘å”¯ä¸€å­èŠ‚ç‚¹")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æŒ‡å‘çˆ¶èŠ‚ç‚¹")]),t._v("\n  sibling"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æŒ‡å‘å…„å¼ŸèŠ‚ç‚¹")]),t._v("\n  firstEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æŒ‡å‘å½“å‰èŠ‚ç‚¹æœ‰æ›´æ–°çš„ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹")]),t._v("\n  lastEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æŒ‡å‘å½“å‰èŠ‚ç‚¹æœ‰æ›´æ–°çš„æœ€åä¸€ä¸ªå­èŠ‚ç‚¹")]),t._v("\n  nextEffect"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æŒ‡å‘ä¸‹ä¸€ä¸ªè¦æ›´æ–°çš„å­èŠ‚ç‚¹")]),t._v("\n  effectTag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//è¡¨ç¤ºå½“å‰èŠ‚ç‚¹è¦è¿›è¡Œä½•ç§æ›´æ–°")]),t._v("\n  alternate"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æŒ‡å‘å‰ä¸€ä¸ªæ ‘çš„å¯¹åº”èŠ‚ç‚¹")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("p",[t._v("returnç”¨æ¥ç”ŸæˆEffect Listï¼Œé€šè¿‡å‘ä¸Šmergeçš„æ–¹å¼æŠŠå­Effect Listå‘ä¸Šåˆå¹¶ï¼Œæœ€ç»ˆåˆå¹¶åˆ°æ ¹èŠ‚ç‚¹ï¼Œæ ¹èŠ‚ç‚¹æ‹¿åˆ°Effect Listå°±å¯ä»¥å¯¹ç›¸åº”çš„èŠ‚ç‚¹è¿›è¡Œæ›´æ–°æ¸²æŸ“äº†")]),t._v(" "),s("h4",{attrs:{id:"fiberæ‰§è¡Œé˜¶æ®µ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fiberæ‰§è¡Œé˜¶æ®µ"}},[t._v("#")]),t._v(" Fiberæ‰§è¡Œé˜¶æ®µ")]),t._v(" "),s("p",[t._v("æ¯æ¬¡æ¸²æŸ“æœ‰ä¸¤ä¸ªé˜¶æ®µï¼šReconciliationï¼ˆåè°ƒrenderé˜¶æ®µï¼‰å’ŒCommitï¼ˆæäº¤é˜¶æ®µï¼‰")]),t._v(" "),s("ul",[s("li",[t._v("åè°ƒé˜¶æ®µï¼šå¯ä»¥è®¤ä¸ºæ˜¯Diffé˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µå¯ä»¥è¢«ä¸­æ–­ï¼Œè¿™ä¸ªé˜¶æ®µä¼šæ‰¾å‡ºæ‰€æœ‰èŠ‚ç‚¹å˜æ›´ï¼Œä¾‹å¦‚èŠ‚ç‚¹æ–°å¢ã€åˆ é™¤ã€å±æ€§å˜æ›´ç­‰ç­‰ï¼Œè¿™äº›å˜æ›´Reactç§°ä¹‹ä¸ºå‰¯ä½œç”¨ï¼ˆEffectï¼‰")]),t._v(" "),s("li",[t._v("æäº¤é˜¶æ®µï¼šå°†ä¸Šä¸€ä¸ªé˜¶æ®µè®¡ç®—å‡ºæ¥çš„éœ€è¦å¤„ç†çš„å‰¯ä½œç”¨ï¼ˆEffectsï¼‰ä¸€æ¬¡æ‰§è¡Œäº†ã€‚è¿™ä¸ªé˜¶æ®µå¿…é¡»åŒæ­¥æ‰§è¡Œï¼Œä¸èƒ½è¢«æ‰“æ–­")])]),t._v(" "),s("p",[t._v("renderé˜¶æ®µ")]),t._v(" "),s("ul",[s("li",[t._v("ä»¥fiber treeä¸ºè“æœ¬ï¼ŒæŠŠæ¯ä¸ªfiberä½œä¸ºä¸€ä¸ªå·¥ä½œå•å…ƒï¼Œè‡ªé¡¶å‘ä¸‹é€èŠ‚ç‚¹æ„é€ "),s("em",[t._v("workInProgress tree")]),t._v("ï¼ˆæ„å»ºä¸­çš„æ–°fiber treeï¼‰")]),t._v(" "),s("li",[t._v("å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼ˆä»¥ç»„ä»¶èŠ‚ç‚¹ä¸ºä¾‹ï¼‰ï¼š")]),t._v(" "),s("li",[s("ol",[s("li",[t._v("å¦‚æœå½“å‰èŠ‚ç‚¹ä¸éœ€è¦æ›´æ–°ï¼Œç›´æ¥æŠŠå­èŠ‚ç‚¹cloneè¿‡æ¥ï¼Œè·³åˆ°5ï¼›è¦æ›´æ–°çš„è¯æ‰“ä¸ªtag")]),t._v(" "),s("li",[t._v("æ›´æ–°å½“å‰èŠ‚ç‚¹çŠ¶æ€ï¼ˆ"),s("code",[t._v("props, state, context")]),t._v("ç­‰ï¼‰")]),t._v(" "),s("li",[t._v("è°ƒç”¨"),s("code",[t._v("shouldComponentUpdate()")]),t._v("ï¼Œ"),s("code",[t._v("false")]),t._v("çš„è¯ï¼Œè·³åˆ°5")]),t._v(" "),s("li",[t._v("è°ƒç”¨"),s("code",[t._v("render()")]),t._v("è·å¾—æ–°çš„å­èŠ‚ç‚¹ï¼Œå¹¶ä¸ºå­èŠ‚ç‚¹åˆ›å»ºfiberï¼ˆåˆ›å»ºè¿‡ç¨‹ä¼šå°½é‡å¤ç”¨ç°æœ‰fiberï¼Œå­èŠ‚ç‚¹å¢åˆ ä¹Ÿå‘ç”Ÿåœ¨è¿™é‡Œï¼‰")]),t._v(" "),s("li",[t._v("å¦‚æœæ²¡æœ‰äº§ç”Ÿchild fiberï¼Œè¯¥å·¥ä½œå•å…ƒç»“æŸï¼ŒæŠŠeffect listå½’å¹¶åˆ°returnï¼Œå¹¶æŠŠå½“å‰èŠ‚ç‚¹çš„siblingä½œä¸ºä¸‹ä¸€ä¸ªå·¥ä½œå•å…ƒï¼›å¦åˆ™æŠŠchildä½œä¸ºä¸‹ä¸€ä¸ªå·¥ä½œå•å…ƒ")]),t._v(" "),s("li",[t._v("å¦‚æœæ²¡æœ‰å‰©ä½™å¯ç”¨æ—¶é—´äº†ï¼Œç­‰åˆ°ä¸‹ä¸€æ¬¡ä¸»çº¿ç¨‹ç©ºé—²æ—¶æ‰å¼€å§‹ä¸‹ä¸€ä¸ªå·¥ä½œå•å…ƒï¼›å¦åˆ™ï¼Œç«‹å³å¼€å§‹åš")]),t._v(" "),s("li",[t._v("å¦‚æœæ²¡æœ‰ä¸‹ä¸€ä¸ªå·¥ä½œå•å…ƒäº†ï¼ˆå›åˆ°äº†workInProgress treeçš„æ ¹èŠ‚ç‚¹ï¼‰ï¼Œç¬¬1é˜¶æ®µç»“æŸï¼Œè¿›å…¥pendingCommitçŠ¶æ€")])])]),t._v(" "),s("li",[t._v("å®é™…ä¸Šæ˜¯1-6çš„"),s("em",[t._v("å·¥ä½œå¾ªç¯")]),t._v("ï¼Œ7æ˜¯å‡ºå£ï¼Œå·¥ä½œå¾ªç¯æ¯æ¬¡åªåšä¸€ä»¶äº‹ï¼Œåšå®Œçœ‹è¦ä¸è¦å–˜å£æ°”ã€‚å·¥ä½œå¾ªç¯ç»“æŸæ—¶ï¼ŒworkInProgress treeçš„æ ¹èŠ‚ç‚¹èº«ä¸Šçš„effect listå°±æ˜¯æ”¶é›†åˆ°çš„æ‰€æœ‰side effectï¼ˆå› ä¸ºæ¯åšå®Œä¸€ä¸ªéƒ½å‘ä¸Šå½’å¹¶ï¼‰")]),t._v(" "),s("li",[t._v("æ‰€ä»¥ï¼Œæ„å»ºworkInProgress treeçš„è¿‡ç¨‹å°±æ˜¯diffçš„è¿‡ç¨‹ï¼Œé€šè¿‡"),s("code",[t._v("requestIdleCallback")]),t._v("æ¥è°ƒåº¦æ‰§è¡Œä¸€ç»„ä»»åŠ¡ï¼Œæ¯å®Œæˆä¸€ä¸ªä»»åŠ¡åå›æ¥çœ‹çœ‹æœ‰æ²¡æœ‰æ’é˜Ÿçš„ï¼ˆæ›´ç´§æ€¥çš„ï¼‰ï¼Œæ¯å®Œæˆä¸€ç»„ä»»åŠ¡ï¼ŒæŠŠæ—¶é—´æ§åˆ¶æƒäº¤è¿˜ç»™ä¸»çº¿ç¨‹ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡"),s("code",[t._v("requestIdleCallback")]),t._v("å›è°ƒå†ç»§ç»­æ„å»ºworkInProgress tree")]),t._v(" "),s("li",[t._v("P.S.Fiberä¹‹å‰çš„reconcilerè¢«ç§°ä¸ºStack reconcilerï¼Œå°±æ˜¯å› ä¸ºè¿™äº›è°ƒåº¦ä¸Šä¸‹æ–‡ä¿¡æ¯æ˜¯ç”±ç³»ç»Ÿæ ˆæ¥ä¿å­˜çš„ã€‚è™½ç„¶ä¹‹å‰ä¸€æ¬¡æ€§åšå®Œï¼Œå¼ºè°ƒæ ˆæ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œèµ·ä¸ªåå­—åªæ˜¯ä¸ºäº†ä¾¿äºåŒºåˆ†Fiber reconciler")])]),t._v(" "),s("p",[t._v("reactä¸»è¦åˆ†ä»¥ä¸‹ä¸¤ä¸ªé˜¶æ®µï¼šï¼ˆç®€åŒ–ç‰ˆï¼‰")]),t._v(" "),s("p",[t._v("renderé˜¶æ®µï¼ˆæŒ‡çš„æ˜¯åˆ›å»ºfiberçš„è¿‡ç¨‹ï¼‰")]),t._v(" "),s("p",[t._v("1ã€ä¸ºæ¯ä¸ªèŠ‚ç‚¹åˆ›å»ºæ–°çš„fiberï¼ˆworkInProgessï¼‰ï¼ˆå¯èƒ½æ˜¯å¤ç”¨ï¼‰ç”Ÿæˆä¸€é¢—æœ‰æ–°çŠ¶æ€çš„workInProgessæ ‘")]),t._v(" "),s("p",[t._v("2ã€åˆæ¬¡æ¸²æŸ“çš„æ—¶å€™ï¼ˆæˆ–åˆ›å»ºæŸä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼‰ä¼šä¸ºè¿™ä¸ªfiberåˆ›å»ºçœŸå®çš„domå®ä¾‹å¹¶ä¸”å°†å½“å‰èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ä¹Ÿéƒ½æ’å…¥åˆ°å½“å‰èŠ‚ç‚¹")]),t._v(" "),s("p",[t._v("3ã€å¦‚æœä¸æ˜¯åˆæ¬¡æ¸²æŸ“çš„è¯ï¼Œå°±å¯¹æ¯”æ–°æ—§çš„fiberçŠ¶æ€å°†äº§ç”Ÿçš„æ›´æ–°çš„fiberèŠ‚ç‚¹æœ€ç»ˆé€šè¿‡é“¾è¡¨çš„å½¢å¼æŒ‚è½½åˆ°RootFiberä¸Š")]),t._v(" "),s("p",[t._v("commité˜¶æ®µ")]),t._v(" "),s("p",[t._v("1ã€æ‰§è¡Œç”Ÿå‘½å‘¨æœŸ")]),t._v(" "),s("p",[t._v("2ã€ä¼šå°†RootFiberä¸Šè·å–åˆ°çš„é‚£æ¡é“¾è¡¨å³EffectListæ ¹æ®é“¾è¡¨ä¸Šçš„æ ‡è¯†æ¥æ“ä½œé¡µé¢")]),t._v(" "),s("p",[t._v("ä¸¾ä¸ªæ —å­ğŸŒ°")]),t._v(" "),s("div",{staticClass:"language-react line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('class Home extend React.component {\n  componentWillReceiveProps() {}\n  componentDidMount() {}\n  componentDidUpdate() {}\n  componentWillUnmount() {}\n  .....\n  render() {\n    return (\n       <div class="start">\n          <div class="next">\n              <h1>mi1</h1>\n              <h2>mi2</h2>\n              <h3>mi3</h3>\n          </div>\n      </div>\n   )\n  }\n}\nReactDom.render(<Home />, document.getElementById(\'root\'))\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("p",[t._v("ä»¥å®ƒä¸ºä¾‹åˆ›å»ºfiber treeï¼ˆåˆå§‹åŒ–é˜¶æ®µï¼‰ï¼š")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302180150.png",alt:"image-20201122221551099"}})]),t._v(" "),s("p",[t._v("æ„é€ EffectListçš„æµç¨‹")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302180214.png",alt:"image-20201118232504514"}})]),t._v(" "),s("h2",{attrs:{id:"fiberä¸­çš„èŠ‚ç‚¹å¤ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fiberä¸­çš„èŠ‚ç‚¹å¤ç”¨"}},[t._v("#")]),t._v(" Fiberä¸­çš„èŠ‚ç‚¹å¤ç”¨")]),t._v(" "),s("p",[t._v("ä¸¾ä¸ªæ —å­ğŸŒ°")]),t._v(" "),s("p",[t._v("è¿™é‡Œæˆ‘ä»¬ç»§ç»­ç”¨ä¸Šé¢çš„æ —å­")]),t._v(" "),s("div",{staticClass:"language-react line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('class Home extend React.component {\n  static getDerivedStateFromProps(){}\n  componentDidMount() {}\n  .....\n  render() {\n    return (\n       <div class="start">\n          <div class="next">\n              <h1>mi1</h1>\n              <h2>mi2</h2>\n              <h3>mi3</h3>\n          </div>\n      </div>\n   )\n  }\n}\nReactDom.render(<Home />, document.getElementById(\'root\'))\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302180236.png",alt:"image-20201122220044790"}})]),t._v(" "),s("p",[t._v("reactåº”ç”¨ä»å§‹è‡³ç»ˆç®¡ç†ç€æœ€åŸºæœ¬çš„ä¸‰æ ·ä¸œè¥¿")]),t._v(" "),s("blockquote",[s("p",[t._v("1ã€Rootï¼ˆæ•´ä¸ªåº”ç”¨çš„æ ¹ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡å¹¶ä¸æ˜¯Fiberï¼Œæœ‰ä¸ªå±æ€§æŒ‡å‘currentæ ‘ï¼Œè¿˜æœ‰ä¸€ä¸ªå±æ€§æŒ‡å‘workInProgessæ ‘ï¼‰")]),t._v(" "),s("p",[t._v("2ã€currentæ ‘ï¼ˆæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯fiberï¼Œä¿å­˜çš„æ˜¯ä¸Šä¸€æ¬¡çš„çŠ¶æ€ï¼Œå¹¶ä¸”æ¯ä¸ªfiberèŠ‚ç‚¹éƒ½å¯¹åº”ç€ä¸€ä¸ªjsxèŠ‚ç‚¹ï¼‰")]),t._v(" "),s("p",[t._v("3ã€workInProgessæ ‘ï¼ˆæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯fiberï¼Œä¿å­˜çš„æ˜¯æœ¬æ¬¡æ–°çš„çŠ¶æ€å¹¶ä¸”æ¯ä¸ªfiberèŠ‚ç‚¹éƒ½å¯¹åº”ä¸€ä¸ªjsxèŠ‚ç‚¹ï¼‰")]),t._v(" "),s("p",[t._v("åˆæ¬¡æ¸²æŸ“çš„æ—¶å€™å¹¶æ²¡æœ‰currentæ ‘ï¼ŒReactåœ¨ä¸€å¼€å§‹åˆ›å»ºRootçš„åŒæ—¶å°±ä¼šåˆ›å»ºä¸€ä¸ªuninitialFiberï¼ˆæœªåˆå§‹åŒ–çš„fiberï¼‰ï¼ŒåŒæ—¶è®©reactçš„currentæŒ‡å‘uninitialFiberï¼Œä¹‹åå†å»åˆ›å»ºä¸€ä¸ªæœ¬æ¬¡è¦ç”¨åˆ°çš„workInProgessã€‚")])]),t._v(" "),s("h2",{attrs:{id:"fiberå¸¦æ¥çš„è´Ÿé¢å½±å“"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fiberå¸¦æ¥çš„è´Ÿé¢å½±å“"}},[t._v("#")]),t._v(" Fiberå¸¦æ¥çš„è´Ÿé¢å½±å“")]),t._v(" "),s("p",[t._v("å¯¹ç”Ÿå‘½å‘¨æœŸçš„å½±å“")]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Reconciliationé˜¶æ®µ")]),t._v("\ncomponentWillMount\ncomponentWillReceiveProps\nshouldComponentUpdate\ncomponentWillUpdate\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Commité˜¶æ®µ")]),t._v("\ncomponentDidMount\ncomponentDidUpdate\ncomponentWillUnmount\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("p",[t._v("åœ¨Reconciliationé˜¶æ®µFiberæ¶æ„å› ä¸ºä½¿ç”¨äº†æ–°çš„ç®—æ³•ï¼Œä¹Ÿå¼•å‘äº†ä¸€äº›é—®é¢˜ï¼Œåœ¨commité˜¶æ®µä¹‹å‰ï¼ŒReconciliationé˜¶æ®µçš„æ‰€æœ‰å‡½æ•°éƒ½æœ‰å¯èƒ½ä¼šè¢«æ‰§è¡Œå¤šæ¬¡ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä½¿ç”¨äº†è¯¸å¦‚AJAXè¿™æ ·çš„å¼‚æ­¥è¯·æ±‚ï¼Œé‚£ä¹ˆAJAXä¼šè¢«æ— è°“åœ°æ— æ•°æ¬¡è°ƒç”¨ï¼Œæ˜¾ç„¶ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆReactä¼šåœ¨16ä¹‹åçš„ç‰ˆæœ¬å°†componentWillReceivePropsç­‰ç”Ÿå‘½å‘¨æœŸå‡½æ•°è®¾ç½®ä¸ºunsafeçš„åŸå› ã€‚")]),t._v(" "),s("ul",[s("li",[t._v("ä¸ºä»€ä¹ˆcomponentWillMountã€componentWillReceivePropsã€componentWillUpdateè¿™ä¸‰ä¸ªå‡½æ•°è¢«æ›¿æ¢æˆäº†getDerivedStateFromPropså‘¢ï¼Ÿ\n"),s("ul",[s("li",[t._v("é¦–å…ˆæˆ‘ä»¬çœ‹ä¸‹getDerivedStateFromPropsï¼Œå®ƒæ˜¯ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œæ‰€ä»¥å‡½æ•°ä½“å†…ä¸èƒ½è®¿é—®thisï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œçº¯å‡½æ•°æœ‰ä¸ªå¥½å¤„å°±æ˜¯ç”±è¾“å…¥å†³å®šè¾“å‡ºï¼Œä¸å­˜åœ¨å‰¯ä½œç”¨çš„æ“ä½œã€‚æ‰€ä»¥ä¸€èˆ¬å¼€å‘è€…ä¹Ÿä¸ä¼šåœ¨è¿™é‡Œåšajaxç­‰å­˜åœ¨å‰¯ä½œç”¨çš„æ“ä½œã€‚è¿™æ ·å°±é¿å…äº†fiberæ¶æ„ä¸‹ä¹‹å‰ç”Ÿå‘½å‘¨æœŸè¢«å¤šæ¬¡è°ƒç”¨åå­˜åœ¨çš„ä¸€äº›bug")])])])]),t._v(" "),s("div",{staticClass:"language-javascript line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDerivedStateFromProps")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("nextProps"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prevState")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//æ ¹æ®nextPropså’ŒprevStateè®¡ç®—å‡ºé¢„æœŸçš„çŠ¶æ€æ”¹å˜ï¼Œè¿”å›ç»“æœä¼šè¢«é€ç»™setState")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("React16.4åŠä»¥åçš„ç”Ÿå‘½å‘¨æœŸ")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://gitee.com/krialy/images/raw/master/source/20210302180255.png",alt:"image-20201122145258225"}})]),t._v(" "),s("h2",{attrs:{id:"q-a"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#q-a"}},[t._v("#")]),t._v(" Q&A")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("å€˜è‹¥reconcilationè¢«ä¸­æ–­äº†ï¼Œæ˜¯å¦ä¼šå½±å“é¡µé¢çš„æ•ˆæœï¼Ÿ")]),t._v(" "),s("ul",[s("li",[t._v("reconcilationè¢«ä¸­æ–­åªæœ‰å¯èƒ½æ˜¯æ¯”å®ƒä¼˜å…ˆçº§æ›´é«˜çš„ä»»åŠ¡ï¼Œä¾‹å¦‚ç”¨æˆ·ç‚¹å‡»äº‹ä»¶ç­‰ï¼Œæ˜¾ç„¶è¿™ä¸ªæ—¶å€™å¦‚æœreconcilationä¸ä¸­æ–­æ‰ä¼šå½±å“ç”¨æˆ·ä½“éªŒ")])])]),t._v(" "),s("li",[s("p",[t._v("Reconcilationæ˜¯å¼‚æ­¥çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚æœåœ¨Reconcilationè¿˜æ²¡å®Œæˆçš„æ—¶å€™æƒ³è·å–å¸ƒå±€ä¿¡æ¯æ˜¯å¦ä¼šå—åˆ°å½±å“ï¼Ÿ")]),t._v(" "),s("ul",[s("li",[t._v("å¹¶ä¸ä¼šï¼Œå¦‚æœreconcilationè¿˜æ²¡å®Œæˆï¼Œæˆ‘ä»¬åªèƒ½è·å–åˆ°ä¹‹å‰çš„çŠ¶æ€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨commité˜¶æ®µä¹‹åæ¥åšè¿™äº›æ“ä½œ")])])]),t._v(" "),s("li",[s("p",[t._v("ä¸ºä»€ä¹ˆåœ¨ä½ä¼˜å…ˆçº§ä»»åŠ¡è¢«ä¸­æ–­äº†ï¼Œè½¬è€Œå»æ‰§è¡Œé«˜ä¼˜å…ˆçº§ä»»åŠ¡ä¹‹åå›æ¥åªèƒ½"),s("strong",[t._v("é‡æ–°æ‰§è¡Œ")]),t._v("ä¸Šæ¬¡è¢«ä¸­æ–­çš„ä½ä¼˜å…ˆçº§ä»»åŠ¡å•å…ƒå‘¢ï¼Ÿè¿™æ ·ä¸æ˜¯ä¼šé€ æˆæ€§èƒ½ä¸Šçš„æµªè´¹å—ï¼Ÿè¿™ä¹Ÿæ˜¯é€ æˆä¸ºä»€ä¹ˆç”Ÿå‘½å‘¨æœŸä¼šè¢«å¤šæ¬¡è°ƒç”¨çš„åŸå› ")]),t._v(" "),s("ul",[s("li",[t._v("é‡æ–°æ‰§è¡Œâ€”â€”å› ä¸ºæˆ‘ä»¬å¹¶ä¸çŸ¥é“ä¸€ä¸ªå•å…ƒçš„è®¡ç®—æ—¶é—´æ˜¯å¤šå°‘ï¼Œè¿™æ˜¯ä¼šé€ æˆé‡æ–°æ‰§è¡Œçš„ç›´æ¥åŸå› ï¼Œæˆ‘ä»¬èƒ½åšçš„å°±æ˜¯åœ¨rICä¸­å°½é‡å¯¹æ¯”æ›´å¤šçš„fiberã€‚")])])]),t._v(" "),s("li",[s("p",[t._v("ä½¿ç”¨äº†fiberè¿™ç§æ•°æ®ç»“æ„æ˜¯åä¸æ˜¯ä¼šå¾’å¢æ€§èƒ½å—ï¼Ÿ")]),t._v(" "),s("ul",[s("li",[t._v("æ˜¯çš„ï¼Œä¼šå¾’å¢æ€§èƒ½ï¼Œä½†æ˜¯è¿™äº›æ€§èƒ½ç”¨æˆ·æ˜¯æ„Ÿå—ä¸åˆ°çš„ï¼Œä¹Ÿè®¸ä½ è·‘åˆ†é«˜ï¼Œä½†æ˜¯ä½ ç”¨æˆ·ä½“éªŒå´ä¸ä¸€å®šé«˜ï¼Œç”¨æˆ·çš„ä¸»è§‚æ„Ÿå—æ˜¯åŠ¨ç”»æ˜¯å¦æµç•…ã€‚")])])])]),t._v(" "),s("blockquote",[s("p",[t._v("å¦‚æœæœ‰ä¸æ­£ç¡®çš„åœ°æ–¹ï¼Œå°ä¼™ä¼´ä»¬å¯ä»¥ç›´æ¥æŒ‡å‡ºï¼Œäº’ç›¸å­¦ä¹ ")])]),t._v(" "),s("comment-comment")],1)}),[],!1,null,null,null);s.default=r.exports}}]);